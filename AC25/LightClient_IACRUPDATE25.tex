\documentclass[runningheads]{llncs}
%
\usepackage[T1]{fontenc}
% T1 fonts will be used to generate the final print and online PDFs,
% so please use T1 fonts in your manuscript whenever possible.
% Other font encondings may result in incorrect characters.
%
\pagestyle{plain}
\usepackage{geometry}
\usepackage{graphicx}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%


\usepackage{hyperref}
% If you use the hyperref package, please uncomment the following two-three lines
% to display URLs in blue roman font according to Springer's eBook style:
\usepackage{color}
\renewcommand\UrlFont{\color{blue}\rmfamily}
\urlstyle{rm}

\usepackage{url}

%\usepackage[hyphen]{url}
\usepackage{xspace}
%\usepackage{graphicx}
\let\proof\relax \let\endproof\relax
\usepackage{amsmath,amsthm,amssymb}
\usepackage{amsfonts}
%\usepackage{amssymb} %\therefore
\usepackage{cryptocode}
\usepackage{framed}
% \usepackage[parfill]{parskip} % activate to begin paragraphs with an empty line rather than an indent

 %%% packages
\usepackage{booktabs}
\usepackage{array}
\usepackage{paralist}
\usepackage{verbatim}
\usepackage{subfig}
\usepackage{mathrsfs}
\usepackage[normalem]{ulem}
\usepackage{soul}


\newcommand{\prove}{\ensuremath{\mathsf{Prove}}\xspace}
\newcommand{\group}{\ensuremath{\mathsf{group}}\xspace}
\newcommand{\ck}{\ensuremath{\mathsf{ck}}\xspace}
\newcommand{\key}[1]{\ensuremath{\mathsf{ck}_{#1}}\xspace}
\newcommand{\konefirst}{\ensuremath{\key{1,[:m']}}\xspace}
\newcommand{\konesecond}{\ensuremath{\key{1,[m':]}}\xspace}
\newcommand{\ktwofirst}{\ensuremath{\key{2,[:m']}}\xspace}
\newcommand{\ktwosecond}{\ensuremath{\key{2,[m':]}}\xspace}
\newcommand{\avec}{\ensuremath{\mathbf{\mathsf{a}}}\xspace}
\newcommand{\vvec}{\ensuremath{\mathbf{v}}\xspace}

\newcommand{\Avec}{\ensuremath{\mathbf{A}}\xspace}

\newcommand{\bvec}{\ensuremath{\mathbf{\mathsf{b}}}\xspace}
\newcommand{\zL}{\ensuremath{\mathit{z_L}}\xspace}
\newcommand{\zR}{\ensuremath{\mathit{z_R}}\xspace}

\newcommand{\afirst}{\ensuremath{\avec_{[:m']}}\xspace}
\newcommand{\asecond}{\ensuremath{\avec_{[m':]}}\xspace}
\newcommand{\Afirst}{\ensuremath{\Avec_{[:m']}}\xspace}
\newcommand{\Asecond}{\ensuremath{\Avec_{[m':]}}\xspace}

\newcommand{\vfirst}{\ensuremath{\vvec_{[:m']}}\xspace}
\newcommand{\vsecond}{\ensuremath{\vvec_{[m':]}}\xspace}
\newcommand{\bfirst}{\ensuremath{\bvec_{[:m']}}\xspace}
\newcommand{\bsecond}{\ensuremath{\bvec_{[m':]}}\xspace}

\newcommand{\CL}{\ensuremath{\mathit{C_L}}\xspace}
\newcommand{\CR}{\ensuremath{\mathit{C_R}}\xspace}
\newcommand{\TL}{\ensuremath{\mathit{T_L}}\xspace}
\newcommand{\TR}{\ensuremath{\mathit{T_R}}\xspace}

\newcommand{\negl}{\ensuremath{\mathit{negl}}\xspace}
\newcommand{\einn}{\ensuremath{\mathit{E}_{\mathit{inn}}}\xspace}
\newcommand{\eout}{\ensuremath{\mathit{E}_{\mathit{out}}}\xspace}
\newcommand{\ginn}[1]{\ensuremath{\mathbb{G}_{\mathit{#1,inn}}}\xspace}
\newcommand{\gout}[1]{\ensuremath{\mathbb{G}_{\mathit{#1,out}}}\xspace}
\newcommand{\gtinn}{\ensuremath{\mathbb{G}_{\mathit{T,inn}}}\xspace}
\newcommand{\gtout}{\ensuremath{\mathbb{G}_{\mathit{T,out}}}\xspace}
\newcommand{\sginn}[1]{\ensuremath{g_{\mathit{#1,inn}}}\xspace}
\newcommand{\sgout}[1]{\ensuremath{g_{\mathit{#1,out}}}\xspace}
\newcommand{\sgtinn}{\ensuremath{g_{\mathit{T,inn}}}\xspace}
\newcommand{\sgtout}{\ensuremath{g_{\mathit{T,out}}}\xspace}

\newcommand{\indexoneinn}{\ensuremath{\mathit{1,inn}}\xspace}
\newcommand{\indextwoinn}{\ensuremath{\mathit{2,inn}}\xspace}

\newcommand{\indexoneout}{\ensuremath{\mathit{1,out}}\xspace}
\newcommand{\indextwoout}{\ensuremath{\mathit{2,out}}\xspace}


\newcommand{\epinn}{\ensuremath{\mathit{e}_{\mathit{inn}}}\xspace}
\newcommand{\epout}{\ensuremath{\mathit{e}_{\mathit{out}}}\xspace}
\newcommand{\block}{\ensuremath{\mathsf{block}}\xspace}
\newcommand{\LCseed}{\ensuremath{\mathit{LC.seed}}\xspace}
\newcommand{\bgamma}{\boldsymbol{\gamma}}
\newcommand{\bsigma}{\boldsymbol{\sigma}}
\newcommand{\GoneBLS}{\mathbb{G}_{1, \mathit{BLS}}\xspace}
\newcommand{\GtwoBLS}{\mathbb{G}_{2, \mathit{BLS}}\xspace}
\newcommand{\GTBLS}{\mathbb{G}_{T, \mathit{BLS}}\xspace}

\newcommand{\goneBLS}{\mathit{g}_{1, \mathit{BLS}}\xspace}
\newcommand{\gtwoBLS}{\mathit{g}_{2, \mathit{BLS}}\xspace}
\newcommand{\gTBLS}{\mathit{g}_{T, \mathit{BLS}}\xspace}

\newcommand{\eBLS}{\mathit{e}_{\mathit{BLS}}\xspace}
\newcommand{\HBLS}{\mathit{H}_{\mathit{BLS}}\xspace}
\newcommand{\HPoP}{\mathit{H}_{\mathit{PoP}}\xspace}
\newcommand{\Hinn}{\mathit{H}_{\mathit{inn}}\xspace}
\newcommand{\piinn}{\pi_{\mathit{inn}}\xspace}
\newcommand{\PoP}{\mathit{inn}\xspace}

\newcommand{\Rla}{\mathcal{R}^{\mathit{incl}}_{\mathsf{ba}}\xspace}
\newcommand{\Ra}{\mathcal{R}^{\mathit{incl}}_{\mathsf{pa}}\xspace}
\newcommand{\Rvt}{\mathcal{R}^{\mathit{incl}}_{\mathsf{c}}\xspace}

\newcommand{\Rlacom}{\mathcal{R}^{\mathit{incl}}_{\mathsf{ba},\mathit{com}}\xspace}
\newcommand{\Racom}{\mathcal{R}^{\mathit{incl}}_{\mathsf{pa},\mathit{com}}\xspace}
\newcommand{\Rvtcom}{\mathcal{R}^{\mathit{incl}}_{\mathsf{c},\mathit{com}}\xspace}

\newcommand{\Pla}{\mathscr{P}_{\mathsf{ba}}\xspace}
\newcommand{\Pa}{\mathscr{P}_{\mathsf{pa}}\xspace}
\newcommand{\Pvt}{\mathscr{P}_{\mathsf{c}}\xspace}

\newcommand{\Plastar}{\mathscr{P}_{\mathsf{ba}}^{\ast}\xspace}
\newcommand{\Pastar}{\mathscr{P}_{\mathsf{pa}}^{\ast}\xspace}
\newcommand{\Pvtstar}{\mathscr{P}_{\mathsf{c}}^{\ast}\xspace}

\newcommand{\Plah}{\mathscr{P}_{\mathsf{ba}}^{h}\xspace}
\newcommand{\Pah}{\mathscr{P}_{\mathsf{pa}}^{h}\xspace}
\newcommand{\Pvth}{\mathscr{P}_{\mathsf{c}}^{h}\xspace}
\newcommand{\kate}{\ensuremath{\mathsf{KZG}}\xspace}
\newcommand{\ewnp}{e.w.n.p.}

\spnewtheorem{construction}[theorem]{Instantiation}{\bfseries}{\itshape}
\spnewtheorem{assumption}[theorem]{Assumption}{\bfseries}{\itshape}
\spnewtheorem{test_claim}[theorem]{Claim}{\bfseries}{\itshape}
\spnewtheorem{observation}[theorem]{Observation}{\bfseries}{\itshape}

\begin{document}

\title{Accountable Light Client Systems for \\ Proof-of-Stake Blockchains}
%\author{Anonymous et al.}  
%\maketitle

\author{Oana Ciobotaru \inst{1} \thanks{Research done while first author was affiliated at Web3 Foundation. First and third author contributed equally to this research.} 
\and Fatemeh Shirazi \inst{2} \and Alistair Stewart \inst{3} \and Sergey Vasilyev \inst{3}}


\institute{Pi Squared \email{firstname.lastname@gmail.com} \and Parity Technology \email{firstname.lastname@gmail.com} \and Web3 Foundation \email{firstname@web3.foundation}}
\maketitle


\begin{abstract} A major challenge for blockchain interoperability is having an on-chain light client protocol that is both efficient 
and secure. We present a protocol that provides short proofs about the state of a decentralised consensus protocol while being 
able to detect misbehaving parties. To do this naively, a verifier would need to maintain an updated list of all participants' public 
keys which makes the corresponding proofs long. Existing solutions either are not able to detect misbehaving parties (i.e. lack 
accountability) or are not efficient. We define and design a committee key scheme with short proofs that does not include any 
of the individual participants' public keys in plain which makes it very efficient. Our committee key scheme, in turn, can use 
one of our two custom designed SNARKs which have fast prover times. Our committee key scheme can be used in an 
accountable light client system as the main cryptographic core for building bridges between proof-of-stake blockchains. 
By allowing a large number of participants, our scheme allows decentralisation and interoperability without compromise. 
Finally, we implement a prototype of our custom SNARKs for which we provide benchmarks.

\keywords{Custom SNARKs \and Accountable light clients \and Secure bridges}
\end{abstract}


\section{Introduction} \label{sec_intro}
\input{intro.tex}

\section{Implementation} \label{sec_implementation}
%\input{anon_implementation}
\input{implementation}

\vspace{-1.3cm}
\section{Preliminaries} \label{sec_prelims}
\input{preliminaries}
\vspace{-0.07in}
\input{elliptic_curves_and_pairings}
\vspace{-0.07in}
\input{short_multisignatures_def}
\vspace{-0.07in}
%\input{multisignatures_def}
\input{committee_key_scheme}
\input{conditional_NP_relations}
\input{short_snarks_def}
\input{poly_proto_poly_comm}
\input{lagrange_bases}

%\vspace{-0.5cm}
\section{Custom SNARKs for Aggregation } \label{sec_apk_proofs}
\input{no_witness_relations.tex}

\vspace{-0.7cm}
\section{Conclusions}\label{conclusions}
\input{conclusions}

%\section{Acknowledgements} \label{sec_ack}
%\input{acknowledgements}

%\bibliography{bibliography}
%\bibliographystyle{ieeetr}
\bibliographystyle{splncs04}
\bibliography{bibliography}

\onecolumn
\appendix
%\newpackage{geometry}
\newgeometry{margin=0.9in}
\section*{Appendices}
\input{multisignatures_def.tex}
\input{appendix_snarks.tex}
\input{appendix_ranged_polynomial_protocols.tex}
\input{alternative_choice_h.tex}
%\input{packed_accountable.tex}
\input{missing_proofs_custom_snarks.tex}
\input{appendix_compiler}
\input{appendix_full_accountable.tex}
\input{apk_vs_plonk_comparison.tex}
\input{appendix_CKS_proof.tex}
\input{new_light_client_model_updated}
\input{light_client_instantiation}
\input{appendix_soundness_proof.tex}
\input{appendix_accountability_proof.tex}
%\input{appendix_step_1_compiler.tex}
\input{appendix_ethereum.tex}

\end{document}
